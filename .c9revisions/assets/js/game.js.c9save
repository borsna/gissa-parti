{"ts":1347478565411,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"//List of parties\nvar par = {\n\t    \"all\": \t\"Alliansen\",\n\t    \"c\": \t\"Centerpartiet\",\n\t    \"rg\": \t\"De r&ouml;dgr&ouml;na\",\n\t    \"fi\": \t\"Feministiskt initiativ\",\n\t    \"fp\": \t\"Folkpartiet\",\n\t    \"jr\": \t\"Jordbrukarnas riksf&ouml;rbund\",\n\t    \"kd\": \t\"Kristdemokraterna\",\n\t    \"la\": \t\"Lantmannapartiet\",\n\t    \"labp\": \"Lantmanna- och borgarepartiet\",\n\t    \"lisp\": \"Liberala samlingspartiet\",\n\t    \"mp\": \t\"Milj&ouml;partiet\",\n\t    \"m\": \t\"Moderaterna\",\n\t    \"npf\": \t\"Nationella framstegspartiet\",\n\t    \"nyd\": \t\"Ny demokrati\",\n\t    \"pp\": \t\"Piratpartiet\",\n\t    \"sd\": \t\"Sverigedemokraterna\",\n\t    \"k_h\": \t\"Sveriges kommunistiska parti, H&ouml;glundarna\",\n\t    \"k_k\": \t\"Sverges kommunistiska parti, Kilbommarna\",\n\t    \"svp\": \t\"Sverges socialdemokratiska v&auml;nsterparti\",\n\t    \"lp\": \t\"Sveriges liberala parti\",\n\t    \"s\": \t\"Socialdemokraterna\",\n\t    \"v\": \t\"V&auml;nsterpartiet\"\n};\n\nvar korp_url = \"http://demosb.spraakdata.gu.se/cgi-bin/korp/korp.cgi?callback=?\";\nvar corpus = \"VIVILL\";\nvar cqp = '[(pos = \"NN\")]';\nvar current = 0;\nvar current_party = {};\nvar num_result = 0;\nvar correct= 0;\nvar wrong= 0;\n\nfunction generatePartyButtons() {\n\n    $(\"#parties\").html('');\n    $.each(par, function(key, val) {\n        $(\"#parties\").append('<li class=\"party_item\"><a class=\"p_button\" id=\"' + key + '\">' + val + '</a></li>');\n    });\n\n    $(\"#parties\").shuffle();\n    \n    var tmp;\n    \n    if ($(\"#\" + current_party.text_party).length ) {\n    \ttmp = $(\"#\" + current_party.text_party).parent();\n    }else{\n    \ttmp = '<li class=\"party_item\"><a class=\"p_button\" id=\"' + current_party.text_party + '\">' + current_party.text_party + '</a></li>';\n    }\n\n    $(\"#\" + current_party.text_party).parent().remove();\n\t\n    $('.party_item:gt(2)').remove();\n\n    //$('.p_button').remove();\n    $(\"#parties\").append(tmp);\n    $(\"#parties\").shuffle();\n\t\n\t$('#parties').listview('refresh');\n\t$('#game-content').slideDown(\"fast\");\n\n    //Click-event for guess\n    $('.p_button').click(function(event) {\n        event.preventDefault();\n        guessParty($(this).attr('id'));\n    });\n}\n\n$(document).ready(function() {\n\t// Load first sentence\n\tloadSentence(1);\n});\n\nfunction loadSentence(num) {\n\t$('#game-content').slideUp(\"fast\");\n\t\n    var data = {\n        command: 'query',\n        corpus: corpus,\n        cqp: cqp,\n        start: num,\n        end: (num),\n        defaultcontext: '1 sentence'\n    };\n\n    data.show_struct = ['text_year', 'text_party', 'text_type'];\n\n    $.ajax({\n        url: korp_url,\n        dataType: \"jsonp\",\n        data: data,\n        traditional: true,\n        success: corpus_results\n    });\n}\n\n// recive the data and render\nfunction corpus_results(data) {\n    if (current == 0) {\n        num_result = data.hits;\n        var num = Math.floor(Math.random() * num_result) + 1;\n        current = num;\n        loadSentence(num);\n        return 0;\n    }\n\n    if(data.kwic[0].tokens.length > 40){\n        var num = Math.floor(Math.random() * num_result) + 1;\n        loadSentence(num);\n        return 0;\n    }\n    \n    var punct = ['.', ',', '!', '?', ';', '-', '\"', '\\'', '(', ')'];\n\n    var i = 0;\n    var korp_sentence = \"\";\n    $.each(data.kwic[0].tokens, function(key, val) {\n        if (jQuery.inArray(val.word, punct) > -1) korp_sentence += val.word;\n        else korp_sentence += ' ' + val.word;\n    });\n\n    $(\"#random\").html(korp_sentence).hide().fadeIn(\"fast\");;\n    current_party = data.kwic[0].structs;\n    generatePartyButtons();\n}\n\n// check the answer and get new sentence\nfunction guessParty(party) {\n    var status = \"\";\n    if (party == current_party.text_party) {\n        correct++;\n        $(\"#correct\").fadeOut(\"fast\").html(correct).fadeIn(\"fast\");\n        $(\"#info\").addClass('correct');\n        $(\"#info\").removeClass('wrong');        \n        status = \"R&auml;tt! <strong>\"+par[current_party.text_party]+\"</strong> (\"+current_party.text_year+\")\";\n    } else {\n        wrong++;\n        $(\"#wrong\").fadeOut(\"fast\").html(wrong).fadeIn(\"fast\");\n        $(\"#info\").addClass('wrong');\n        $(\"#info\").removeClass('correct');\n        status = \"Nu blev det lite fel, r&auml;tt svar &auml;r: <strong>\"+par[current_party.text_party]+\"</strong> (\"+current_party.text_year+\")\";\n    }\n    $(\"#info\").html(status+\"<p><em>\"+$(\"#random\").html()+\"</em></p>\").hide().fadeIn(\"slow\");\n    \n    var num = Math.floor(Math.random() * num_result) + 1;\n    current = num;\n    loadSentence(num);\n}"]],"start1":0,"start2":0,"length1":0,"length2":4384}]],"length":4384}
{"contributors":[],"silentsave":false,"ts":1347478738540,"patch":[[{"diffs":[[0,"par = {\n"],[-1,"\t"],[0,"    \"all"]],"start1":22,"start2":22,"length1":17,"length2":16},{"diffs":[[0," \"all\": "],[-1,"\t"],[1," "],[0,"\"Allians"]],"start1":33,"start2":33,"length1":17,"length2":17},{"diffs":[[0,"ansen\",\n"],[-1,"\t"],[0,"    \"c\":"]],"start1":47,"start2":47,"length1":17,"length2":16},{"diffs":[[0,"   \"c\": "],[-1,"\t"],[1,"   "],[0,"\"Centerp"]],"start1":56,"start2":56,"length1":17,"length2":19},{"diffs":[[0,"erpartiet\",\n"],[-1,"\t"],[0,"    \"rg\": \t\""]],"start1":72,"start2":72,"length1":25,"length2":24},{"diffs":[[0,"  \"rg\": "],[-1,"\t"],[1,"  "],[0,"\"De r&ou"]],"start1":86,"start2":86,"length1":17,"length2":18},{"diffs":[[0,"r&ouml;na\",\n"],[-1,"\t"],[0,"    \"fi\": \t\""]],"start1":109,"start2":109,"length1":25,"length2":24},{"diffs":[[0,"  \"fi\": "],[-1,"\t"],[1,"  "],[0,"\"Feminis"]],"start1":123,"start2":123,"length1":17,"length2":18},{"diffs":[[0,"iativ\",\n"],[-1,"\t"],[0,"    \"fp\""]],"start1":151,"start2":151,"length1":17,"length2":16},{"diffs":[[0,"  \"fp\": "],[-1,"\t"],[1,"  "],[0,"\"Folkpar"]],"start1":161,"start2":161,"length1":17,"length2":18},{"diffs":[[0,"lkpartiet\",\n"],[-1,"\t"],[0,"    \"jr\": \t\""]],"start1":174,"start2":174,"length1":25,"length2":24},{"diffs":[[0,"  \"jr\": "],[-1,"\t"],[1,"  "],[0,"\"Jordbru"]],"start1":188,"start2":188,"length1":17,"length2":18},{"diffs":[[0,"rbund\",\n"],[-1,"\t"],[0,"    \"kd\""]],"start1":224,"start2":224,"length1":17,"length2":16},{"diffs":[[0,"  \"kd\": "],[-1,"\t"],[1,"  "],[0,"\"Kristde"]],"start1":234,"start2":234,"length1":17,"length2":18},{"diffs":[[0,"okraterna\",\n"],[-1,"\t"],[0,"    \"la\": \t\""]],"start1":253,"start2":253,"length1":25,"length2":24},{"diffs":[[0,"  \"la\": "],[-1,"\t"],[1,"  "],[0,"\"Lantman"]],"start1":267,"start2":267,"length1":17,"length2":18},{"diffs":[[0,"napartiet\",\n"],[-1,"\t"],[0,"    \"labp\": "]],"start1":285,"start2":285,"length1":25,"length2":24},{"diffs":[[0,"repartiet\",\n"],[-1,"\t"],[0,"    \"lisp\": "]],"start1":330,"start2":330,"length1":25,"length2":24},{"diffs":[[0,"gspartiet\",\n"],[-1,"\t"],[0,"    \"mp\": \t\""]],"start1":370,"start2":370,"length1":25,"length2":24},{"diffs":[[0,"  \"mp\": "],[-1,"\t"],[1,"  "],[0,"\"Milj&ou"]],"start1":384,"start2":384,"length1":17,"length2":18},{"diffs":[[0,"l;partiet\",\n"],[-1,"\t"],[0,"    \"m\": \t\"M"]],"start1":403,"start2":403,"length1":25,"length2":24},{"diffs":[[0,"   \"m\": "],[-1,"\t"],[1,"   "],[0,"\"Moderat"]],"start1":416,"start2":416,"length1":17,"length2":19},{"diffs":[[0,"deraterna\",\n"],[-1,"\t"],[0,"    \"npf\": \t"]],"start1":430,"start2":430,"length1":25,"length2":24},{"diffs":[[0," \"npf\": "],[-1,"\t"],[1," "],[0,"\"Natione"]],"start1":445,"start2":445,"length1":17,"length2":17},{"diffs":[[0,"gspartiet\",\n"],[-1,"\t"],[0,"    \"nyd\": \t"]],"start1":473,"start2":473,"length1":25,"length2":24},{"diffs":[[0," \"nyd\": "],[-1,"\t"],[1," "],[0,"\"Ny demo"]],"start1":488,"start2":488,"length1":17,"length2":17},{"diffs":[[0,"demokrati\",\n"],[-1,"\t"],[0,"    \"pp\": \t\""]],"start1":501,"start2":501,"length1":25,"length2":24},{"diffs":[[0,"  \"pp\": "],[-1,"\t"],[1,"  "],[0,"\"Piratpa"]],"start1":515,"start2":515,"length1":17,"length2":18},{"diffs":[[0,"rtiet\",\n"],[-1,"\t"],[0,"    \"sd\""]],"start1":533,"start2":533,"length1":17,"length2":16},{"diffs":[[0,"  \"sd\": "],[-1,"\t"],[1,"  "],[0,"\"Sverige"]],"start1":543,"start2":543,"length1":17,"length2":18},{"diffs":[[0,"okraterna\",\n"],[-1,"\t"],[0,"    \"k_h\": \t"]],"start1":564,"start2":564,"length1":25,"length2":24},{"diffs":[[0," \"k_h\": "],[-1,"\t"],[1," "],[0,"\"Sverige"]],"start1":579,"start2":579,"length1":17,"length2":17},{"diffs":[[0,"glundarna\",\n"],[-1,"\t"],[0,"    \"k_k\": \t"]],"start1":626,"start2":626,"length1":25,"length2":24},{"diffs":[[0," \"k_k\": "],[-1,"\t"],[1," "],[0,"\"Sverges"]],"start1":641,"start2":641,"length1":17,"length2":17},{"diffs":[[0,"lbommarna\",\n"],[-1,"\t"],[0,"    \"svp\": \t"]],"start1":682,"start2":682,"length1":25,"length2":24},{"diffs":[[0,"\n    \"svp\": "],[-1,"\t"],[1," "],[0,"\"Sverges soc"]],"start1":693,"start2":693,"length1":25,"length2":25},{"diffs":[[0,"sterparti\",\n"],[-1,"\t"],[0,"    \"lp\": \t\""]],"start1":742,"start2":742,"length1":25,"length2":24},{"diffs":[[0,"  \"lp\": "],[-1,"\t"],[1,"  "],[0,"\"Sverige"]],"start1":756,"start2":756,"length1":17,"length2":18},{"diffs":[[0,"parti\",\n"],[-1,"\t"],[0,"    \"s\":"]],"start1":785,"start2":785,"length1":17,"length2":16},{"diffs":[[0,"   \"s\": "],[-1,"\t"],[1,"   "],[0,"\"Sociald"]],"start1":794,"start2":794,"length1":17,"length2":19},{"diffs":[[0,"terna\",\n"],[-1,"\t"],[0,"    \"v\":"]],"start1":819,"start2":819,"length1":17,"length2":16},{"diffs":[[0,"   \"v\": "],[-1,"\t"],[1,"   "],[0,"\"V&auml;"]],"start1":828,"start2":828,"length1":17,"length2":19},{"diffs":[[0,"gth ) {\n    "],[-1,"\t"],[1,"    "],[0,"tmp = $(\"#\" "]],"start1":1410,"start2":1410,"length1":25,"length2":28},{"diffs":[[0,"se{\n    "],[-1,"\t"],[1,"    "],[0,"tmp = '<"]],"start1":1483,"start2":1483,"length1":17,"length2":20},{"diffs":[[0,"rrent =="],[-1,""],[0,""],[1,"="],[0," 0) {\n  "]],"start1":2661,"start2":2661,"length1":16,"length2":17},{"diffs":[[0,"(\"fast\")"],[-1,";"],[0,""],[1,""],[0,";\n    cu"]],"start1":3352,"start2":3352,"length1":17,"length2":16}]],"length":4386,"saved":false}
